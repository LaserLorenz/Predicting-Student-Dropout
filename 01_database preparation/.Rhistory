filter((be/sem)<15) # Filtert zwei Ausreißer:
my_plot <-
ggplot(plot_data, aes(note, (be/sem))) + geom_point(aes(colour = as.factor(endgrd)), alpha = 0.5) +
labs(title = "note vs. BE vs. status", x = "avg note", y = "avg count BE", colour = "status") +
scale_color_discrete(labels=c("Sucessful", "Paused", "HSw", "Not enrolled", "Quit", "Officially", "Exam", "Other"))
ggsave(filename = "note_exams_endgrd3_pointplot.png", device = "png", plot = my_plot, path = "~/Desktop/Masterarbeit_local/02_preanalysis/02_output")
rm(plot_data, my_plot)
# note vs be vs success ####
plot_data <- dataset_sum %>%
filter((be/sem)<15) # Filtert Ausreißer:
my_plot <- ggplot(plot_data, aes(note, (be/sem))) + geom_point(aes(colour = as.factor(success)), alpha = 0.5) +
labs(title = "note vs. be vs. success", x = "avg note", y = "count BE", colour = "success") +
scale_color_discrete(labels=c("Quit", "Success", "Enrolled"))
ggsave(filename = "note_exams_success_pointplot.png", device = "png", plot = my_plot, path = "~/Desktop/Masterarbeit_local/02_preanalysis/02_output")
rm(plot_data, my_plot)
#without success == 2
plot_data <- dataset_sum %>%
filter(success!=2) %>%
filter((be/sem)<15) # Filtert Ausreißer:
my_plot <- ggplot(plot_data, aes(note, (be/sem))) + geom_point(aes(colour = as.factor(success)), alpha = 0.5) +
labs(title = "note vs. be vs. success", x = "avg note", y = "count BE", colour = "success") +
scale_color_discrete(labels=c("Quit", "Success"))
ggsave(filename = "note_exams_success2_pointplot.png", device = "png", plot = my_plot, path = "~/Desktop/Masterarbeit_local/02_preanalysis/02_output")
rm(plot_data, my_plot)
# note vs be vs endgrd, sem <=2 ####
dataset_sum2 <- dataset %>%
filter(!is.na(pnote)) %>%
filter(sem <=2) %>%
group_by(id, pstatus) %>%
summarise(endgrd = mean(endgrd), count = n(), note = mean(pnote), staat = toString(staat), geschl = toString(geschl), age = mean(age, sem = mean(sem)), source = min(source), sem = max(sem, na.rm=TRUE)) %>%
mutate(geschl = ifelse (startsWith(geschl, "W"), "W", "M"), staat = ifelse (startsWith(staat, "D"), "D", "N")) %>%
mutate(fail = if (endgrd == 1){0}else{1}) %>%
mutate(BE = ifelse (pstatus == "BE", as.numeric(count), 0)) %>%
mutate(NB = ifelse (pstatus == "NB", as.numeric(count), 0)) %>%
mutate(EN = ifelse (pstatus == "EN", as.numeric(count), 0)) %>%
group_by(id) %>%
summarise(endgrd = mean(endgrd), note = mean(note), staat = toString(staat), geschl = toString(geschl), age = mean(age, sem = mean(sem)), be = sum(BE), nb = sum(NB), en = sum(EN), source = min(source), sem = max(sem, na.rm=TRUE)) %>%
mutate(geschl = ifelse (startsWith(geschl, "W"), "W", "M"), staat = ifelse (startsWith(staat, "D"), "D", "N")) %>%
mutate(success = ifelse(endgrd == 1, 1, ifelse(endgrd == 2 | endgrd == 3, 2, 0)))
plot_data <- dataset_sum2 %>%
filter((be/sem)<15) # Filtert zwei Ausreißer:
my_plot <-
ggplot(plot_data, aes(note, (be/sem))) + geom_jitter(aes(colour = as.factor(endgrd)), alpha = 0.5) +
labs(title = "note vs. BE vs. status", x = "avg note", y = "avg count BE", colour = "status") +
scale_color_discrete(labels=c("Sucessful", "Paused", "Enrolled", "HSw", "Not enrolled", "Quit", "Officially", "Exam", "Other"))
ggsave(filename = "note_exams_endgrd_sem2_pointplot_ji.png", device = "png", plot = my_plot, path = "~/Desktop/Masterarbeit_local/02_preanalysis/02_output")
rm(plot_data, my_plot)
# without endgrd == 3
plot_data <- dataset_sum2 %>%
filter(endgrd!=3) %>%
filter((be/sem)<15) # Filtert zwei Ausreißer:
my_plot <-
ggplot(plot_data, aes(note, (be/sem))) + geom_jitter(aes(colour = as.factor(endgrd)), alpha = 0.5) +
labs(title = "note vs. BE vs. status", x = "avg note", y = "avg count BE", colour = "status") +
scale_color_discrete(labels=c("Sucessful", "Paused", "HSw", "Not enrolled", "Quit", "Officially", "Exam", "Other"))
ggsave(filename = "note_exams_endgrd3_sem2_pointplot_ji.png", device = "png", plot = my_plot, path = "~/Desktop/Masterarbeit_local/02_preanalysis/02_output")
rm(plot_data, my_plot, dataset_sum2)
# endgrd vs anfdat ####
my_plot <- ggplot(dataset, aes(x = 1, y = anfdat)) + geom_jitter(aes(colour = as.factor(endgrd)), alpha = 0.5) +
labs(title = "anfdat vs endgrd", x = "anfdat", y = "index", colour = "edgrd") +
scale_color_discrete(labels=c("Sucessful", "Paused", "Enrolled", "HSw", "Not enrolled", "Quit", "Officially", "Exam", "Other"))
ggsave(filename = "anfdat_endgrd.png", device = "png", plot = my_plot, path = "~/Desktop/Masterarbeit_local/02_preanalysis/02_output")
rm(my_plot)
# anfdat vs endgrd_barplot ####
my_data <- dataset %>%
group_by(id) %>%
summarise(anfdat = min(anfdat), endgrd = mean(endgrd)) %>%
mutate(success = ifelse(endgrd == 1, 1, ifelse(endgrd == 2 | endgrd == 3, 2, 0))) %>%
group_by(anfdat, success) %>%
summarise(count = n()) %>%
filter(anfdat > "2007-01-01") %>%
mutate(success = as.factor(success))
my_plot <- ggplot(data = my_data, aes(x = anfdat, y = count, fill = success)) + geom_bar(stat = "identity") +
labs(title = "anfdat vs count vs success", x = "anfdat", y = "count", colour = "edgrd") +
scale_fill_discrete(labels=c("Quit", "Sucessful", "Enrolled, \npaused"))
ggsave(plot = my_plot, filename = "anfdat_success_barplot.png", device = "png", path = "~/Desktop/Masterarbeit_local/02_preanalysis/02_output")
rm(my_data, my_plot)
# pdat_overview ####
my_data <- dataset %>%
mutate(pnote = round(pnote)) %>%
group_by(sem, pnote) %>%
summarise(count = n()) %>%
filter(sem > 0, sem < 12) %>%
mutate(pnote = as.factor(pnote))
my_plot <- ggplot(data = my_data, aes(x = sem, y = count, fill = pnote)) + geom_bar(stat = "identity")# +
ggsave(plot = my_plot, filename = "pnote_sem_barplot.png", device = "png", path = "~/Desktop/Masterarbeit_local/02_preanalysis/02_output")
rm(my_data, my_plot)
# nb exams vs note vs success
plot_data <- dataset_sum %>%
filter(success!=2 & success != 3) %>%
filter((be/sem)<15) # Filtert Ausreißer:
my_plot <- ggplot(plot_data, aes(note, (nb/sem))) + geom_jitter(aes(colour = as.factor(success)), alpha = 0.5) +
labs(title = "note vs. nb vs. success", x = "avg note", y = "count NB", colour = "success") +
scale_color_discrete(labels=c("Quit", "Success"))
ggsave(filename = "note_exams_success3_pointplot.png", device = "png", plot = my_plot, path = "~/Desktop/Masterarbeit_local/02_preanalysis/02_output")
rm(plot_data, my_plot)
### EXPORT #########################################################################################
write.table(dataset, file = "~/Desktop/Masterarbeit_local/02_preanalysis/02_output/dataset.csv", sep = ";", row.names = FALSE)
write.table(dataset_sum, file = "~/Desktop/Masterarbeit_local/02_preanalysis/02_output/dataset_id.csv", sep = ";", row.names = FALSE)
write.table(dataset_idsem, file = "~/Desktop/Masterarbeit_local/02_preanalysis/02_output/dataset_idsem.csv", sep = ";", row.names = FALSE)
dummy <- dataset %>%
group_by(id) %>%
summarise(endgrd = mean (endgrd), note = mean(pnote), staat_d = mean(staat_d),
sex_m = mean(sex_m), age = mean(age), source = mean(source), sem = max(sem, na.rm = TRUE),
success = mean(success), exams_total = n(),
be = sum(pstatus == 1)
# REPLACE
# create dataset_id: group_by ID
dataset_sum <- dataset %>%
filter(!is.na(pnote)) %>%
group_by(id, pstatus) %>%
summarise(endgrd = mean(endgrd), count = n(), note = mean(pnote), "staat = d" = mean("staat = d"),
"geschl = m" = mean("geschl = m"), age = mean(age), source = min(source),
sem = max(sem, na.rm=TRUE), success = mean(success))# %>%
#mutate(geschl = ifelse (startsWith(geschl, "W"), "W", "M"),
#       staat = ifelse (startsWith(staat, "D"), "D", "N")) %>%
#mutate(fail = if (endgrd == 1){0}else{1}) %>%
mutate(BE = ifelse (pstatus == "BE", as.numeric(count), 0)) %>%
mutate(NB = ifelse (pstatus == "NB", as.numeric(count), 0)) %>%
mutate(EN = ifelse (pstatus == "EN", as.numeric(count), 0)) %>%
group_by(id) %>%
summarise(endgrd = mean(endgrd), note = mean(note), staat = toString(staat),
geschl = toString(geschl), age = mean(age), be = sum(BE), nb = sum(NB), en = sum(EN),
source = min(source), sem = max(sem, na.rm=TRUE), success = mean(success)) %>%
mutate(geschl = ifelse (startsWith(geschl, "W"), "W", "M"),
staat = ifelse (startsWith(staat, "D"), "D", "N"))
# create dataset_idsem: group_by ID & sem
dataset_idsem <- dataset %>%
filter(!is.na(pnote)) %>%
group_by(id, sem, pstatus) %>%
summarise(endgrd = mean(endgrd), count = n(), note = mean(pnote), staat = toString(staat),
geschl = toString(geschl), age = mean(age), source = min(source), success = mean(success)) %>%
mutate(geschl = ifelse (startsWith(geschl, "W"), "W", "M"),
staat = ifelse (startsWith(staat, "D"), "D", "N")) %>%
mutate(BE = ifelse (pstatus == "BE", as.numeric(count), 0)) %>%
mutate(NB = ifelse (pstatus == "NB", as.numeric(count), 0)) %>%
mutate(EN = ifelse (pstatus == "EN", as.numeric(count), 0)) %>%
group_by(id, sem) %>%
summarise(endgrd = mean(endgrd), note = mean(note), staat = toString(staat),
geschl = toString(geschl), age = mean(age), be = sum(BE), nb = sum(NB),
en = sum(EN), source = min(source), success = mean(success)) %>%
mutate(geschl = ifelse (startsWith(geschl, "W"), "W", "M"),
staat = ifelse (startsWith(staat, "D"), "D", "N"))
### PLOTS ##########################################################################################
# endgrd distribution by #students and gender ####
endgrd_distr <- dataset_sum %>%
mutate(endgrd = as.factor(endgrd)) %>%
group_by(endgrd, geschl) %>%
#group_by(endgrd) %>%
summarise(count = n())
endgrd_distr_barplot <- ggplot(data = endgrd_distr, aes(x = endgrd, y = count, fill = geschl)) + geom_bar(stat = "identity")
ggsave(plot = endgrd_distr_barplot, filename = "endgrd_distr_barplot.png", device = "png", path = "~/Desktop/Masterarbeit_local/02_preanalysis/02_output")
rm(endgrd_distr, endgrd_distr_barplot)
# note vs be vs endgrd ####
plot_data <- dataset_sum %>%
filter((be/sem)<15) # Filtert vier Ausreißer: 1.7/23, 2.4/15, 3.6/42, 3.6/49
my_plot <-
ggplot(plot_data, aes(note, (be/sem))) + geom_point(aes(colour = as.factor(endgrd)), alpha = 0.5) +
labs(title = "note vs. BE vs. status", x = "avg note", y = "avg count BE", colour = "status") +
scale_color_discrete(labels=c("Sucessful", "Paused", "Enrolled", "HSw", "Not enrolled", "Quit", "Officially", "Exam", "Other"))
ggsave(filename = "note_exams_endgrd_pointplot.png", device = "png", plot = my_plot, path = "~/Desktop/Masterarbeit_local/02_preanalysis/02_output")
rm(plot_data, my_plot)
# wihtout endgrd == 3
plot_data <- dataset_sum %>%
filter(endgrd!=3) %>%
filter((be/sem)<15) # Filtert zwei Ausreißer:
my_plot <-
ggplot(plot_data, aes(note, (be/sem))) + geom_point(aes(colour = as.factor(endgrd)), alpha = 0.5) +
labs(title = "note vs. BE vs. status", x = "avg note", y = "avg count BE", colour = "status") +
scale_color_discrete(labels=c("Sucessful", "Paused", "HSw", "Not enrolled", "Quit", "Officially", "Exam", "Other"))
ggsave(filename = "note_exams_endgrd3_pointplot.png", device = "png", plot = my_plot, path = "~/Desktop/Masterarbeit_local/02_preanalysis/02_output")
rm(plot_data, my_plot)
# note vs be vs success ####
plot_data <- dataset_sum %>%
filter((be/sem)<15) # Filtert Ausreißer:
my_plot <- ggplot(plot_data, aes(note, (be/sem))) + geom_point(aes(colour = as.factor(success)), alpha = 0.5) +
labs(title = "note vs. be vs. success", x = "avg note", y = "count BE", colour = "success") +
scale_color_discrete(labels=c("Quit", "Success", "Enrolled"))
ggsave(filename = "note_exams_success_pointplot.png", device = "png", plot = my_plot, path = "~/Desktop/Masterarbeit_local/02_preanalysis/02_output")
rm(plot_data, my_plot)
#without success == 2
plot_data <- dataset_sum %>%
filter(success!=2) %>%
filter((be/sem)<15) # Filtert Ausreißer:
my_plot <- ggplot(plot_data, aes(note, (be/sem))) + geom_point(aes(colour = as.factor(success)), alpha = 0.5) +
labs(title = "note vs. be vs. success", x = "avg note", y = "count BE", colour = "success") +
scale_color_discrete(labels=c("Quit", "Success"))
ggsave(filename = "note_exams_success2_pointplot.png", device = "png", plot = my_plot, path = "~/Desktop/Masterarbeit_local/02_preanalysis/02_output")
rm(plot_data, my_plot)
# note vs be vs endgrd, sem <=2 ####
dataset_sum2 <- dataset %>%
filter(!is.na(pnote)) %>%
filter(sem <=2) %>%
group_by(id, pstatus) %>%
summarise(endgrd = mean(endgrd), count = n(), note = mean(pnote), staat = toString(staat), geschl = toString(geschl), age = mean(age, sem = mean(sem)), source = min(source), sem = max(sem, na.rm=TRUE)) %>%
mutate(geschl = ifelse (startsWith(geschl, "W"), "W", "M"), staat = ifelse (startsWith(staat, "D"), "D", "N")) %>%
mutate(fail = if (endgrd == 1){0}else{1}) %>%
mutate(BE = ifelse (pstatus == "BE", as.numeric(count), 0)) %>%
mutate(NB = ifelse (pstatus == "NB", as.numeric(count), 0)) %>%
mutate(EN = ifelse (pstatus == "EN", as.numeric(count), 0)) %>%
group_by(id) %>%
summarise(endgrd = mean(endgrd), note = mean(note), staat = toString(staat), geschl = toString(geschl), age = mean(age, sem = mean(sem)), be = sum(BE), nb = sum(NB), en = sum(EN), source = min(source), sem = max(sem, na.rm=TRUE)) %>%
mutate(geschl = ifelse (startsWith(geschl, "W"), "W", "M"), staat = ifelse (startsWith(staat, "D"), "D", "N")) %>%
mutate(success = ifelse(endgrd == 1, 1, ifelse(endgrd == 2 | endgrd == 3, 2, 0)))
plot_data <- dataset_sum2 %>%
filter((be/sem)<15) # Filtert zwei Ausreißer:
my_plot <-
ggplot(plot_data, aes(note, (be/sem))) + geom_jitter(aes(colour = as.factor(endgrd)), alpha = 0.5) +
labs(title = "note vs. BE vs. status", x = "avg note", y = "avg count BE", colour = "status") +
scale_color_discrete(labels=c("Sucessful", "Paused", "Enrolled", "HSw", "Not enrolled", "Quit", "Officially", "Exam", "Other"))
ggsave(filename = "note_exams_endgrd_sem2_pointplot_ji.png", device = "png", plot = my_plot, path = "~/Desktop/Masterarbeit_local/02_preanalysis/02_output")
rm(plot_data, my_plot)
# without endgrd == 3
plot_data <- dataset_sum2 %>%
filter(endgrd!=3) %>%
filter((be/sem)<15) # Filtert zwei Ausreißer:
my_plot <-
ggplot(plot_data, aes(note, (be/sem))) + geom_jitter(aes(colour = as.factor(endgrd)), alpha = 0.5) +
labs(title = "note vs. BE vs. status", x = "avg note", y = "avg count BE", colour = "status") +
scale_color_discrete(labels=c("Sucessful", "Paused", "HSw", "Not enrolled", "Quit", "Officially", "Exam", "Other"))
ggsave(filename = "note_exams_endgrd3_sem2_pointplot_ji.png", device = "png", plot = my_plot, path = "~/Desktop/Masterarbeit_local/02_preanalysis/02_output")
rm(plot_data, my_plot, dataset_sum2)
# endgrd vs anfdat ####
my_plot <- ggplot(dataset, aes(x = 1, y = anfdat)) + geom_jitter(aes(colour = as.factor(endgrd)), alpha = 0.5) +
labs(title = "anfdat vs endgrd", x = "anfdat", y = "index", colour = "edgrd") +
scale_color_discrete(labels=c("Sucessful", "Paused", "Enrolled", "HSw", "Not enrolled", "Quit", "Officially", "Exam", "Other"))
ggsave(filename = "anfdat_endgrd.png", device = "png", plot = my_plot, path = "~/Desktop/Masterarbeit_local/02_preanalysis/02_output")
rm(my_plot)
# anfdat vs endgrd_barplot ####
my_data <- dataset %>%
group_by(id) %>%
summarise(anfdat = min(anfdat), endgrd = mean(endgrd)) %>%
mutate(success = ifelse(endgrd == 1, 1, ifelse(endgrd == 2 | endgrd == 3, 2, 0))) %>%
group_by(anfdat, success) %>%
summarise(count = n()) %>%
filter(anfdat > "2007-01-01") %>%
mutate(success = as.factor(success))
my_plot <- ggplot(data = my_data, aes(x = anfdat, y = count, fill = success)) + geom_bar(stat = "identity") +
labs(title = "anfdat vs count vs success", x = "anfdat", y = "count", colour = "edgrd") +
scale_fill_discrete(labels=c("Quit", "Sucessful", "Enrolled, \npaused"))
ggsave(plot = my_plot, filename = "anfdat_success_barplot.png", device = "png", path = "~/Desktop/Masterarbeit_local/02_preanalysis/02_output")
rm(my_data, my_plot)
# pdat_overview ####
my_data <- dataset %>%
mutate(pnote = round(pnote)) %>%
group_by(sem, pnote) %>%
summarise(count = n()) %>%
filter(sem > 0, sem < 12) %>%
mutate(pnote = as.factor(pnote))
my_plot <- ggplot(data = my_data, aes(x = sem, y = count, fill = pnote)) + geom_bar(stat = "identity")# +
ggsave(plot = my_plot, filename = "pnote_sem_barplot.png", device = "png", path = "~/Desktop/Masterarbeit_local/02_preanalysis/02_output")
rm(my_data, my_plot)
# nb exams vs note vs success
plot_data <- dataset_sum %>%
filter(success!=2 & success != 3) %>%
filter((be/sem)<15) # Filtert Ausreißer:
my_plot <- ggplot(plot_data, aes(note, (nb/sem))) + geom_jitter(aes(colour = as.factor(success)), alpha = 0.5) +
labs(title = "note vs. nb vs. success", x = "avg note", y = "count NB", colour = "success") +
scale_color_discrete(labels=c("Quit", "Success"))
ggsave(filename = "note_exams_success3_pointplot.png", device = "png", plot = my_plot, path = "~/Desktop/Masterarbeit_local/02_preanalysis/02_output")
rm(plot_data, my_plot)
### EXPORT #########################################################################################
write.table(dataset, file = "~/Desktop/Masterarbeit_local/02_preanalysis/02_output/dataset.csv", sep = ";", row.names = FALSE)
write.table(dataset_sum, file = "~/Desktop/Masterarbeit_local/02_preanalysis/02_output/dataset_id.csv", sep = ";", row.names = FALSE)
write.table(dataset_idsem, file = "~/Desktop/Masterarbeit_local/02_preanalysis/02_output/dataset_idsem.csv", sep = ";", row.names = FALSE)
dummy <- dataset %>%
group_by(id) %>%
summarise(endgrd = mean (endgrd), note = mean(pnote), staat_d = mean(staat_d),
sex_m = mean(sex_m), age = mean(age), source = mean(source), sem = max(sem, na.rm = TRUE),
success = mean(success), exams_total = n(),
be = sum(pstatus == 1))
dummy <- dataset %>%
group_by(id) %>%
summarise(endgrd = mean (endgrd), note = mean(pnote), staat_d = mean(staat_d),
sex_m = mean(sex_m), age = mean(age), source = mean(source), sem = max(sem, na.rm = TRUE),
success = mean(success), exams_total = n(),
be = sum(pstatus == 1) )
dummy <- dataset %>%
group_by(id) %>%
summarise(endgrd = mean (endgrd), note = mean(pnote), staat_d = mean(staat_d),
sex_m = mean(sex_m), age = mean(age), source = mean(source), sem = max(sem, na.rm = TRUE),
success = mean(success), exams_total = n(),
be = sum(pstatus == 1), nb = sum(pstatus == 2), en = sum(pstatus == 3) )
View(dummy)
dummy <- dataset %>%
group_by(id, sem) %>%
summarise(endgrd = mean (endgrd), note = mean(pnote), staat_d = mean(staat_d),
sex_m = mean(sex_m), age = mean(age), source = mean(source), sem = max(sem, na.rm = TRUE),
success = mean(success), exams_total = n(),
be = sum(pstatus == 1), nb = sum(pstatus == 2), en = sum(pstatus == 3)
)
dummy <- dataset %>%
group_by(id, sem) %>%
summarise(endgrd = mean (endgrd), note = mean(pnote), staat_d = mean(staat_d),
sex_m = mean(sex_m), age = mean(age), source = mean(source),
success = mean(success), exams_total = n(),
be = sum(pstatus == 1), nb = sum(pstatus == 2), en = sum(pstatus == 3)
)
dataset_id <- dataset_idsem %>%
group_by(id) %>%
summarise(endgrd = mean (endgrd),
staat_d = mean(staat_d), sex_m = mean(sex_m), age = mean(age), source = mean(source),
success = mean(success), note = mean(pnote), exams_total = n(),
be = sum(pstatus == 1), nb = sum(pstatus == 2), en = sum(pstatus == 3), sem = max(sem))
dataset_idsem <- dataset %>%
group_by(id, sem) %>%
summarise(endgrd = mean (endgrd),
staat_d = mean(staat_d), sex_m = mean(sex_m), age = mean(age), source = mean(source),
success = mean(success), note = mean(pnote), exams_total = n(),
be = sum(pstatus == 1), nb = sum(pstatus == 2), en = sum(pstatus == 3)
)
rm(dummy)
dataset_id <- dataset_idsem %>%
group_by(id) %>%
summarise(endgrd = mean (endgrd),
staat_d = mean(staat_d), sex_m = mean(sex_m), age = mean(age), source = mean(source),
success = mean(success), note = mean(pnote), exams_total = n(),
be = sum(pstatus == 1), nb = sum(pstatus == 2), en = sum(pstatus == 3), sem = max(sem))
dataset_id <- dataset_idsem %>%
group_by(id) %>%
summarise(endgrd = mean (endgrd),
staat_d = mean(staat_d), sex_m = mean(sex_m), age = mean(age), source = mean(source),
success = mean(success), note = mean(note), exams_total = n(),
be = sum(pstatus == 1), nb = sum(pstatus == 2), en = sum(pstatus == 3), sem = max(sem))
dataset_id <- dataset_idsem %>%
group_by(id) %>%
summarise(endgrd = mean (endgrd),
staat_d = mean(staat_d), sex_m = mean(sex_m), age = mean(age), source = mean(source),
success = mean(success), note = mean(note), exams_total = n(),
be = sum(be), nb = sum(nb), en = sum(en), sem = max(sem))
View(dataset_idsem)
View(dataset_id)
dataset_id <- dataset_idsem %>%
group_by(id) %>%
summarise(endgrd = mean (endgrd),
staat_d = mean(staat_d), sex_m = mean(sex_m), age = mean(age), source = mean(source),
success = mean(success), note = mean(note), exams_total = sum(exams_total),
be = sum(be), nb = sum(nb), en = sum(en), sem = max(sem))
dataset_id <- dataset_idsem %>%
group_by(id) %>%
summarise(endgrd = mean (endgrd),
staat_d = mean(staat_d), sex_m = mean(sex_m), age = mean(age), source = mean(source),
success = mean(success), note = mean(note), exams_total = sum(exams_total),
be = sum(be), nb = sum(nb), en = sum(en), sem = max(sem, na.rm=TRUE))
rm(dataset, dataset_id, dataset_idsem)
input_data <- read.csv(file = "~/Desktop/Masterarbeit_local/01_database preparation/01_input/dataset_1_HIS.csv", sep = ";")
new_age <- read.csv(file = "~/Desktop/Masterarbeit_local/01_database preparation/01_input/dataset_new age.csv", sep = ";")
names(new_age) <- c("id_new_age", "age")
names(input_data)[names(input_data) == "pdatum"] <- "pdat"
names(input_data)[names(input_data) == "endedat"] <- "enddat"
names(input_data)[names(input_data) == "endegrd"] <- "endgrd"
View(input_data)
View(new_age)
dataset1 <- cbind(input_data, new_age) %>%
select(
-id_new_age, -altersklasse.studiumsbeginn, -abschl, -stg
)
library(ggplot2)
library(dplyr)
dataset1 <- cbind(input_data, new_age) %>%
select(
-id_new_age, -altersklasse.studiumsbeginn, -abschl, -stg
)
rm(input_data, new_age)
View(dataset1)
dataset1 <- dataset1 %>%
mutate (staat = gsub(" ", "", staat))
dataset1[c("staat")][dataset1[c("staat")] == ""] <- "N"
dataset1 %>% filter(is.na(endgrd)) %>% View()
dataset1 %>% filter(!is.na(endgrd)) %>% View()
library(ggplot2)
library(dplyr)
input_data <- read.csv(file = "~/Desktop/Masterarbeit_local/01_database preparation/01_input/dataset_1_HIS.csv", sep = ";")
new_age <- read.csv(file = "~/Desktop/Masterarbeit_local/01_database preparation/01_input/dataset_new age.csv", sep = ";")
names(new_age) <- c("id_new_age", "age")
names(input_data)[names(input_data) == "pdatum"] <- "pdat"
names(input_data)[names(input_data) == "endedat"] <- "enddat"
names(input_data)[names(input_data) == "endegrd"] <- "endgrd"
dataset1 <- cbind(input_data, new_age) %>%
select(
-id_new_age, -altersklasse.studiumsbeginn, -abschl, -stg
)
rm(input_data, new_age)
dataset1 <- dataset1 %>%
mutate (staat = gsub(" ", "", staat))
dataset1[c("staat")][dataset1[c("staat")] == ""] <- "N"
dataset1[c("endgrd")][is.na(dataset1[c("endgrd")])] <- 3                          # ENDGRD <- 3 !!!
nb_ds1 <- dataset1 %>% filter((pstatus == "EN"| pstatus == "NB") & pnote < 5)
dataset1 <- dataset1 %>% setdiff(nb_ds1, dataset1)
rm(nb_ds1)
dataset1 <- dataset1 %>%
mutate(
pdat = as.Date(pdat, "%d.%m.%y"),
anfdat = as.Date(anfdat, "%d.%m.%y"),
enddat = as.Date(enddat, "%d.%m.%y"),
staat = factor(staat),
pnote = as.numeric(pnote)
)
dataset1 <- dataset1[, c(1,7,8,12,9:11,6,2,4,3,5)]
dataset1$source <- rep(1,nrow(dataset1))
dataset1$pnote <- dataset1$pnote / 100
dataset2 <- read.csv(file = "~/Desktop/Masterarbeit_local/01_database preparation/01_input/dataset_2_CAS.csv", sep = ";")
names(dataset2)[names(dataset2) == "Geschlecht"] <- "geschl"
names(dataset2)[names(dataset2) == "Nationalitaet"] <- "staat"
names(dataset2)[names(dataset2) == "Studienbeginn"] <- "anfdat"
names(dataset2)[names(dataset2) == "Vertragsende"] <- "enddat"
names(dataset2)[names(dataset2) == "Kuendigungsgrund"] <- "endgrd"
names(dataset2)[names(dataset2) == "Pruefungsnummer"] <- "pnr"
names(dataset2)[names(dataset2) == "Note"] <- "pnote"
names(dataset2)[names(dataset2) == "Versuch"] <- "pversuch"
names(dataset2)[names(dataset2) == "pruefungsdatum"] <- "pdat"
names(dataset2)[names(dataset2) == "Altersklasse.Studiumsbeginn"] <- "age"
dataset2$pstatus <- (NA)
dataset2$source <- rep(2,nrow(dataset2))
dataset2 <- dataset2[, c(1:3,11,4:6,10,7,12,8,9,13)]
dataset2 <- dataset2 %>%
mutate (
geschl = gsub("maennlich", "M", geschl),
geschl = gsub("weiblich", "W", geschl),
staat = gsub("Deutschland", "D", staat),
enddat = gsub("NULL", "IM", enddat),
endgrd = gsub("NULL", "IM", endgrd),
pnr = gsub("NULL", "AK", pnr),
pnote = gsub("bestanden", "BE", pnote),
pnote = gsub(",", ".", pnote)
)
dataset2[c("staat")][dataset2[c("staat")] == ""] <- "N"
dataset2[c("staat")][dataset2[c("staat")] == "NULL"] <- NA
dataset2[c("endgrd")][is.na(dataset2[c("endgrd")])] <- 3
dataset2[c("endgrd")][dataset2[c("endgrd")] == ""] <- 3
dataset2[c("endgrd")][dataset2[c("endgrd")] == "IM"] <- 3
dataset2[c("endgrd")][dataset2[c("endgrd")] == "Beendigung n. endgueltig nicht bestand.Pruefung/VPr."] <- 8
dataset2[c("endgrd")][dataset2[c("endgrd")] == "Endgueltiger Abbruch des Studiums"] <- 6
dataset2[c("endgrd")][dataset2[c("endgrd")] == "Hochschulwechsel"] <- 4
dataset2[c("endgrd")][dataset2[c("endgrd")] == "sonstige Gruende"] <- 9
dataset2[c("endgrd")][dataset2[c("endgrd")] == "Streichung d.d.HS wg.fehlender Rueckmeldung"] <- 5
dataset2[c("endgrd")][dataset2[c("endgrd")] == "Unterbrechung des Studiums"] <- 2
dataset2[c("pnote")][dataset2[c("pnote")] == "NULL"] <- NA
dataset2[c("pversuch")][dataset2[c("pversuch")] == "NULL"] <- NA
dataset2[c("pdat")][dataset2[c("pdat")] == "NULL"] <- NA
dataset2 <- dataset2 %>%
mutate(
anfdat = as.Date(anfdat, "%Y-%m-%d %H:%M:%OS"),                             # NA ERZEUGUNG !!!
enddat = as.Date(enddat, "%Y-%m-%d %H:%M:%OS"),                             # NA ERZEUGUNG !!!
pdat = as.Date(pdat, "%Y-%m-%d %H:%M:%OS"),                                 # NA ERZEUGUNG !!!
staat = as.character(staat),
geschl = as.factor(dataset2$geschl),
staat = as.factor(dataset2$staat),
endgrd = as.factor(dataset2$endgrd),
pnr = as.character(dataset2$pnr),
pnote = as.numeric(dataset2$pnote)
)
dataset2 <- read.csv(file = "~/Desktop/Masterarbeit_local/01_database preparation/01_input/dataset_2_CAS.csv", sep = ";")
names(dataset2)[names(dataset2) == "Geschlecht"] <- "geschl"
names(dataset2)[names(dataset2) == "Nationalitaet"] <- "staat"
names(dataset2)[names(dataset2) == "Studienbeginn"] <- "anfdat"
names(dataset2)[names(dataset2) == "Vertragsende"] <- "enddat"
names(dataset2)[names(dataset2) == "Kuendigungsgrund"] <- "endgrd"
names(dataset2)[names(dataset2) == "Pruefungsnummer"] <- "pnr"
names(dataset2)[names(dataset2) == "Note"] <- "pnote"
names(dataset2)[names(dataset2) == "Versuch"] <- "pversuch"
names(dataset2)[names(dataset2) == "pruefungsdatum"] <- "pdat"
names(dataset2)[names(dataset2) == "Altersklasse.Studiumsbeginn"] <- "age"
dataset2$pstatus <- (NA)
dataset2$source <- rep(2,nrow(dataset2))
dataset2 <- dataset2[, c(1:3,11,4:6,10,7,12,8,9,13)]
dataset2 <- dataset2 %>%
mutate (
geschl = gsub("maennlich", "M", geschl),
geschl = gsub("weiblich", "W", geschl),
staat = gsub("Deutschland", "D", staat),
enddat = gsub("NULL", "IM", enddat),
endgrd = gsub("NULL", "IM", endgrd),
pnr = gsub("NULL", "AK", pnr),
pnote = gsub("bestanden", "BE", pnote),
pnote = gsub(",", ".", pnote)
)
dataset2[c("staat")][dataset2[c("staat")] == ""] <- "N"
dataset2[c("staat")][dataset2[c("staat")] == "NULL"] <- NA
dataset2[c("endgrd")][is.na(dataset2[c("endgrd")])] <- 3
dataset2[c("endgrd")][dataset2[c("endgrd")] == ""] <- 3
dataset2[c("endgrd")][dataset2[c("endgrd")] == "IM"] <- 3
dataset2[c("endgrd")][dataset2[c("endgrd")] == "Beendigung n. endgueltig nicht bestand.Pruefung/VPr."] <- 8
dataset2[c("endgrd")][dataset2[c("endgrd")] == "Endgueltiger Abbruch des Studiums"] <- 6
dataset2[c("endgrd")][dataset2[c("endgrd")] == "Hochschulwechsel"] <- 4
dataset2[c("endgrd")][dataset2[c("endgrd")] == "sonstige Gruende"] <- 9
dataset2[c("endgrd")][dataset2[c("endgrd")] == "Streichung d.d.HS wg.fehlender Rueckmeldung"] <- 5
dataset2[c("endgrd")][dataset2[c("endgrd")] == "Unterbrechung des Studiums"] <- 2
dataset2[c("pnote")][dataset2[c("pnote")] == "NULL"] <- NA
dataset2[c("pversuch")][dataset2[c("pversuch")] == "NULL"] <- NA
dataset2[c("pdat")][dataset2[c("pdat")] == "NULL"] <- NA
dataset2 <- dataset2 %>%
mutate(
anfdat = as.Date(anfdat, "%Y-%m-%d %H:%M:%OS"),                             # NA ERZEUGUNG !!!
#enddat = as.Date(enddat, "%Y-%m-%d %H:%M:%OS"),                             # NA ERZEUGUNG !!!
pdat = as.Date(pdat, "%Y-%m-%d %H:%M:%OS"),                                 # NA ERZEUGUNG !!!
staat = as.character(staat),
geschl = as.factor(dataset2$geschl),
staat = as.factor(dataset2$staat),
endgrd = as.factor(dataset2$endgrd),
pnr = as.character(dataset2$pnr),
pnote = as.numeric(dataset2$pnote)
)
source('~/Desktop/Masterarbeit_local/01_database preparation/v09.R', echo=TRUE)
rm(dataset)
source('~/Desktop/Masterarbeit_local/01_database preparation/v09.R', echo=TRUE)
dataset <- dataset %>%
mutate( sem = ceiling((as.numeric(pdat) - as.numeric(anfdat)) / 180),
success = ifelse(endgrd == 1, 1, ifelse(endgrd == 3 | endgrd == 2, 2, 0))
)
source('~/Desktop/Masterarbeit_local/01_database preparation/v09.R')
View(dataset)
